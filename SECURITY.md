# Политика безопасности

## Сообщить об уязвимости

Если вы обнаружили уязвимость:

1. **НЕ создавайте** публичный Issue на GitHub
2. Свяжитесь с разработчиком напрямую через Telegram
3. Предоставьте подробную информацию об уязвимости
4. Дайте время на исправление до публичного раскрытия

## Безопасность при развёртывании

### Переменные окружения

**НИКОГДА не коммитьте секреты в git.** Все чувствительные данные должны быть в файле `.env`.

Обязательные переменные (см. `.env.example`):

| Переменная | Описание | Как сгенерировать |
|------------|----------|-------------------|
| `POSTGRES_PASSWORD` | Пароль БД | Сильный пароль (20+ символов) |
| `ENCRYPTION_KEY` | Ключ шифрования Fernet | `python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"` |
| `BOT_TOKEN` | Токен Telegram бота | Получить у [@BotFather](https://t.me/BotFather) |
| `DSN` | Строка подключения к БД | `postgresql://user:password@host/database` |
| `SUPER_ADMIN` | Telegram ID администратора | Ваш Telegram ID |

### Чеклист перед развёртыванием

- [ ] Скопировать `.env.example` в `.env`
- [ ] Сгенерировать уникальный `ENCRYPTION_KEY`
- [ ] Установить сильный `POSTGRES_PASSWORD` (не `qwerty123` и подобные)
- [ ] Настроить `BOT_TOKEN` от BotFather
- [ ] Убедиться, что `.env` в `.gitignore`
- [ ] Не открывать порт БД (5432) в публичный интернет

### После форка (для контрибьюторов)

Если вы форкаете этот репозиторий:

1. **Сгенерируйте новые секреты** — никогда не используйте примеры
2. **Проверьте git историю** — убедитесь, что секреты не закоммичены
3. **Используйте переменные окружения** — никогда не хардкодьте пароли

## Лучшие практики безопасности

### База данных
- Используйте сильные уникальные пароли
- Держите PostgreSQL обновлённым
- Ограничьте доступ к БД только localhost/docker network

### Приложение
- Обновляйте зависимости (`poetry update`)
- Проверяйте права Telegram бота
- Используйте HTTPS в продакшене (настраивается через nginx)

### Сервер
- Включите firewall (ufw)
- Держите систему обновлённой
- Используйте SSH ключи, отключите вход по паролю
- Делайте регулярные бэкапы

## Реализованные меры безопасности

В проекте реализовано:

- **Fernet шифрование** для чувствительных данных пользователей в БД
- **Верификация Telegram initData** для аутентификации
- **Rate limiting** (100 запросов/минуту на IP)
- **Параметризованные SQL запросы** (защита от SQL injection)
- **Принудительный HTTPS** через конфигурацию nginx
